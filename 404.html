<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, height=device-height">
	<style>
		body{
			display: none;
		}
	</style>
</head>

<body>
	<table><tr><td>
		<div id="not-supported">
			请用<a href="https://www.google.cn/intl/zh-CN/chrome/browser/canary.html">Chrome Canary</a>（仅支持Windows/macOS/Android，安装和更新需<a href="https://raw.githubusercontent.com/dou4cc/resource/master/gogo-v1.8.1.7z">翻墙</a>）或<a href="https://download-chromium.appspot.com">Chromium</a>（不能自动更新，需翻墙）浏览本站，并启用下列实验选项：<br>
			- chrome://flags/#enable-javascript-harmony<br>
			- chrome://flags/#enable-experimental-web-platform-features<br>
			<br>
			Windows XP用户可以尝试使用Firefox 52.0，本站不保证支持：<br>
			- <a href="https://download-installer.cdn.mozilla.net/pub/firefox/releases/52.0b7/win32/zh-CN/Firefox%20Setup%2052.0b7.exe">Firefox 52.0b7 win32</a><br>
			- <a href="https://download-installer.cdn.mozilla.net/pub/firefox/releases/52.0b7/win64/zh-CN/Firefox%20Setup%2052.0b7.exe">Firefox 52.0b7 win64</a><br>
			- <a href="https://download-installer.cdn.mozilla.net/pub/firefox/nightly/latest-mozilla-aurora-l10n/firefox-52.0a2.zh-CN.win32.installer.exe">Firefox 52.0a2 win32</a><br>
			- <a href="https://download-installer.cdn.mozilla.net/pub/firefox/nightly/latest-mozilla-aurora-l10n/firefox-52.0a2.zh-CN.win64.installer.exe">Firefox 52.0a2 win64</a><br>
			<br>
			（2017/02/19）</div>
		<div id="not-found" style="display: none">
		   	404 Not Found</div>
	</td></tr></table>
	<script>
		"use strict";
		
		onerror = function(){
			onerror = null;
			document.title = "不支持";
			var hash = document.location.hash.slice(1);
			var uri0 = document.location.href;
			var reg = /^[^:]+:\/+[^/]+\//;
			if((uri0.match(reg) || [0])[0] === (hash.match(reg) || [1])[0]){
				history.replaceState(null, null, hash);
				if(document.location.href !== hash) history.replaceState(null, null, uri0);
			}
		};
	</script>
	<script>
		"use strict";

		a => function*(...[]){``};
		document.append();
		Reflect;
		Promise;

		onerror = null;
		if(top === self){
			try{
				document.title = "Loading";
				const hash = document.location.hash.slice(1);
				if(!hash.startsWith(document.location.origin)) throw null;
				const uri0 = document.location.href;
				history.replaceState(null, null, hash);
				if(document.location.href !== hash){
					history.replaceState(null, null, uri0);
					throw null;
				}
				if(localStorage.length === 0) localStorage.setItem(`
					"use strict";

					if(top === self){
						Reflect;
						onload = null;
						[...document.childNodes].forEach(node => {
							if(!(node instanceof DocumentType)) node.remove();
						});
						const meta = document.createElement("meta");
						meta.setAttribute("charset", "utf-8");
						const head = document.createElement("head");
						head.append(meta);
						const html = document.createElement("html");
						html.append(head, document.createElement("body"));
						document.append(html);
						Promise.resolve().then(() => {
							history.replaceState(null, null, uri0);
							try{
								Reflect.deleteProperty(self, "a");
							}catch(error){}

							const setup = localStorage.key(0);
							const library_source = \`
								const run = thunk => {
									const run = thunk => {
										try{
											thunk();
										}catch(error){
											setTimeout(() => {
												throw error;
											}, 0);
										}
									};
									try{
										run(thunk());
									}catch(error){
										Promise.resolve().then(() => run(() => thunk()()));
									}
								};
								const [hell, is_hell] = (() => {
									const hell_set = new WeakSet;
									return [
										() => {
											const hell0 = callback => {
												if(callbacks){
													callbacks.push(callback);
												}else{
													run(() => () => callback(result));
												}
											};
											let result;
											let callbacks = [];
											hell_set.add(hell0);
											return [
												hell0,
												result1 => {
													result = result1;
													const callbacks1 = callbacks;
													callbacks = null;
													callbacks1.forEach(hell0);
												},
											];
										},
										target => hell_set.has(target),
									];
								})();
								const tickline = (...ticks) => {
									switch(ticks.length){
									case 0:
										return target => {
											if(is_hell(target)){
												let target1;
												target(target => target1 = [tickline()(target)]);
												if(target1) return target1[0];
												const [hell0, resolve] = hell();
												target(target => {
													target = tickline()(target);
													if(is_hell(target)){
														target(resolve);
													}else{
														resolve(target);
													}
												});
												return hell0;
											}
											return target;
										};
									case 1:
										return target => {
											if(is_hell(target)){
												const [hell0, resolve] = hell();
												target(target => resolve(tickline()(ticks[0](target))));
												return tickline()(hell0);
											}
											try{
												return tickline()(ticks[0](target));
											}catch(error){
												setTimeout(() => {
													throw error;
												}, 0);
												return hell()[0];
											}
										};
									case 2: 
										return target => tickline(ticks[1])(tickline(ticks[0])(target));
									default:
										return tickline(ticks[0], tickline(...ticks.slice(1)));
									}
								};
								const gen2tick = gen => tickline(target => {
									target = gen.next(target);
									return target.done ? target.value : gen2tick(gen)(target.value);
								});
								const genfn2tick = genfn => function(...args){
									return gen2tick(genfn.call(this, ...args))();
								};
								const prom2hell = (() => {
									const dp = new WeakMap;
									return promise => dp.get(promise) || (() => {
										const [hell0, resolve] = hell();
										promise.then(result => resolve([null, result]), error => resolve([error]));
										dp.set(promise, hell0);
										return hell0;
									})();
								})();
								({run, hell, is_hell, tickline, gen2tick, genfn2tick, prom2hell});
							\`;
							const library = self.eval('"use strict"; ' + library_source);
							const {run, hell, is_hell, tickline, gen2tick, genfn2tick, prom2hell} = library;

							let crash = false;
							const blocker = event => {
								if(crash) event.stopImmediatePropagation();
							};
							addEventListener("unload", blocker);
							addEventListener("beforeunload", blocker);
							addEventListener("error", event => {
								const timer = setTimeout(() => {
									localStorage.setItem(setup, \`
										const {run, hell, is_hell, tickline, gen2tick, genfn2tick, prom2hell} = library;

										const pre = document.createElement("pre");
										const button = document.createElement("button");
										document.title = "Crash";
										const code = document.createElement("code");
										code.textContent = unescape("\${escape(event.message + "\\n@" + event.filename + ":" + event.lineno + ":" + event.colno)}");
										button.textContent = "Reload";
										button.autofocus = true;
										const [hell0, resolve] = hell();
										button.addEventListener("click", () => {
											button.disabled = true;
											button.textContent = "Reloading";
											resolve();
										});
										pre.append(code);
										document.body.append(pre, button);
										return genfn2tick(function*(){
											yield hell0;
											pre.remove();
											button.remove();
										});
									\`);
									crash = true;
									history.go(0);
								}, 0);
								event.prevent_reload = () => clearTimeout(timer);
							});

							let source;
							let cancel;
							let lock = false;
							const update = () => {
								const source1 = localStorage.getItem(setup);
								if(source1 !== source){
									source = source1;
									if(!lock){
										lock = true;
										genfn2tick(function*(){
											yield (cancel || (() => {}))();
											Function('"use strict";' + source);
											document.title = "Loading";
											if(localStorage.length === 0) localStorage.setItem(setup, source);
											cancel = self.eval('"use strict"; (library, library_source) => {' + source + "}")(library, library_source);
											lock = false;
										})();
									}
								}
							};
							addEventListener("storage", update);
							update();

							const xhr = new XMLHttpRequest;
							const check = () => {
								xhr.open("GET", "/boot.js");
								xhr.setRequestHeader("Cache-Control", "max-age=0");
								xhr.setRequestHeader("token", Date.now() + Math.random().toString().slice(1));
								xhr.send();
							};
							let hell0; 
							xhr.addEventListener("loadstart", () => setTimeout(([hell0] = hell())[1], 6e3));
							xhr.addEventListener("loadend", () => {
								if(xhr.status === 404 || xhr.status >= 200 && xhr.status < 300){
									localStorage.setItem(setup, xhr.responseText || "");
									update();
									hell0(() => requestAnimationFrame(check));
								}else{
									requestAnimationFrame(check);
								}
							});
							check();
						}).catch(error => setTimeout(() => {
							throw error;
						}, 0));
						const uri0 = document.location.href.slice(document.location.origin.length);
						history.replaceState(null, null, "a");
					}
				`, "");
				history.go(0);
			}catch(error){
				document.title = "";
				document.querySelector("#not-supported").style.display = "none";
				document.querySelector("#not-found").style.display = "";
				const xhr = new XMLHttpRequest;
				const check = () => requestAnimationFrame(() => {
					xhr.open("GET", document.location);
					xhr.setRequestHeader("Range", "bytes=0-0");
					xhr.send();
				});
				xhr.addEventListener("loadend", () => xhr.status === 404 ? check() : document.location.reload());
				check();
			}
		}else{
			document.querySelector("#not-supported").style.display = "none";
		}
	</script>
	<style>
		table{
			display: inline;
			border-collapse: collapse;
		}

		td{
			padding: 0;
		}

		div{
			font-size: 1.1em;
			font-family: consolas, menlo, 黑体, monospace;
			line-height: 1.8em;
			text-align: left;
		}

		div a:not([hidden]){
			text-decoration: none;
			display: inline-block;
			position: relative;
		}

		div a:link,
		div a:active{
			color: black;
		}

		div a:visited:not([hidden]){
			color: black;
		}

		div a:focus{
			outline: none;
		}

		div a::before,
		div a::after{
			display: block;
			position: absolute;
			width: 100%;
			height: 0;
			bottom: 0;
			border-bottom-width: 1px;
			border-bottom-color: black;
			content: "";
		}

		div a::before{
			border-bottom-style: solid;
		}

		div a:visited::before{
			border-bottom-color: white;
		}

		div a::after{
			border-bottom-style: dashed;
		}

		div a:focus,
		div a:hover{
			background-color: rgba(0, 0, 0, 0.17);
		}

		body{
			display: block;
			text-align: center;
			overflow: auto;
			border: none;
			margin: 8px;
		}
	</style>
</body>

</html>
